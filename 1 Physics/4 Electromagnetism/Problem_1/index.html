<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Simulating the Effects of the Lorentz Force - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Simulating the Effects of the Lorentz Force";
        var mkdocs_page_input_path = "1 Physics/4 Electromagnetism/Problem_1.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Orbital Period and Orbital Radius: Kepler's Third Law</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Escape Velocities and Cosmic Velocities</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3: Trajectories of a Freely Released Payload Near Earth</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Interference Patterns on a Water Surface</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">4 Electromagnetism</a>
<ul class="current">
<li class="toctree-l2 current"><a class="reference internal current" href="#">Simulating the Effects of the Lorentz Force</a>
<ul class="current">
<li class="toctree-l3"><a class="reference internal" href="#motivation">MOTIVATION</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">4 Electromagnetism</li>
<li class="breadcrumb-item active">Simulating the Effects of the Lorentz Force</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="simulating-the-effects-of-the-lorentz-force">Simulating the Effects of the Lorentz Force</h1>
<h2 id="motivation">MOTIVATION</h2>
<p>The Lorentz force describes how charged particles move in electric and magnetic fields. It is a key concept in electromagnetism, especially in technologies such as particle accelerators, mass spectrometers, fusion devices, and in astrophysics. Understanding this force helps us simulate and predict the motion of particles under the influence of fields.</p>
<h1 id="1-what-is-the-lorentz-force">1. What is the Lorentz Force?</h1>
<p>The Lorentz force is the total force experienced by a charged particle when it moves in the presence of both electric and magnetic fields. It’s described by the equation:</p>
<div class="arithmatex">\[
\mathbf{F} = q(\mathbf{E} + \mathbf{v} \times \mathbf{B})
\]</div>
<p>Where:</p>
<ul>
<li><strong><span class="arithmatex">\(F\)</span></strong> is the total force vector acting on the particle</li>
<li><strong><span class="arithmatex">\(q\)</span></strong> is the electric charge of the particle</li>
<li><strong><span class="arithmatex">\(E\)</span></strong> is the electric field vector</li>
<li><strong><span class="arithmatex">\(v\)</span></strong> is the velocity vector of the particle</li>
<li><strong><span class="arithmatex">\(B\)</span></strong> is the magnetic field vector</li>
<li><strong><span class="arithmatex">\(×\)</span></strong> is the cross product (which determines the direction of the magnetic force)</li>
</ul>
<p>This force causes charged particles to accelerate, change direction, or follow complex curved paths depending on the configuration of the fields.</p>
<hr/>
<h1 id="2-applications-of-the-lorentz-force">2. Applications of the Lorentz Force</h1>
<p>Understanding and controlling the Lorentz force is crucial in many physical systems and technologies:</p>
<ul>
<li><strong>Particle Accelerators</strong>: Use magnetic and electric fields to steer and speed up particles for collisions and research (e.g., LHC at CERN).</li>
<li><strong>Mass Spectrometers</strong>: Separate particles based on mass-to-charge ratio using known magnetic fields.</li>
<li><strong>Fusion Reactors (Tokamaks)</strong>: Use strong magnetic fields to confine hot plasma — a collection of charged particles.</li>
<li><strong>Cathode Ray Tubes</strong>: Use electric and magnetic fields to control the electron beam that lights up the screen.</li>
<li><strong>Auroras (Northern and Southern Lights)</strong>: Caused by charged solar particles deflected by Earth’s magnetic field.</li>
</ul>
<hr/>
<h1 id="3-special-motion-scenarios-and-their-explanations">3. Special Motion Scenarios and Their Explanations</h1>
<h3 id="a-motion-in-a-uniform-magnetic-field-e-0">a) Motion in a Uniform Magnetic Field (<span class="arithmatex">\(E = 0\)</span>)</h3>
<p>If there is no electric field and the magnetic field is constant, the particle experiences a force perpendicular to its velocity and the magnetic field. This results in circular or helical motion.</p>
<ul>
<li>The force does no work (it changes direction, not speed), so kinetic energy remains constant.</li>
<li>The path depends on the angle between velocity and magnetic field:</li>
<li><strong>Perpendicular</strong>: Circular path</li>
<li><strong>At an angle</strong>: Helical path</li>
<li><strong>Parallel</strong>: Straight line (no force)</li>
</ul>
<h4 id="important-formulas">Important Formulas:</h4>
<ul>
<li><strong>Magnetic force</strong>:</li>
</ul>
<div class="arithmatex">\[
\mathbf{F} = q (\mathbf{v} \times \mathbf{B})
\]</div>
<ul>
<li><strong>Larmor radius</strong> (<span class="arithmatex">\(r_L\)</span>):</li>
</ul>
<div class="arithmatex">\[
r_L = \frac{m v_{\perp}}{|q| B}
\]</div>
<ul>
<li><strong>Cyclotron frequency</strong> (<span class="arithmatex">\(\omega\)</span>):</li>
</ul>
<div class="arithmatex">\[
\omega = \frac{|q| B}{m}
\]</div>
<h3 id="b-motion-in-a-uniform-electric-field-b-0">b) Motion in a Uniform Electric Field (<span class="arithmatex">\(B = 0\)</span>)</h3>
<p>When only an electric field is present:</p>
<ul>
<li>The particle accelerates linearly in the direction of the electric field.</li>
<li>The motion resembles free fall under gravity.</li>
</ul>
<h4 id="formula">Formula:</h4>
<ul>
<li><strong>Electric force</strong>:</li>
</ul>
<div class="arithmatex">\[
\mathbf{F} = q \mathbf{E}
\]</div>
<h3 id="c-motion-in-crossed-fields-e-b">c) Motion in Crossed Fields (<span class="arithmatex">\(E ⊥ B\)</span>)</h3>
<p>In this case, the electric and magnetic fields are perpendicular to each other.</p>
<ul>
<li>The particle undergoes a drift — moving in a direction perpendicular to both <span class="arithmatex">\(E\)</span> and <span class="arithmatex">\(B\)</span>.</li>
<li>This drift velocity is the same regardless of mass or charge and is called the <span class="arithmatex">\(E\)</span> cross <span class="arithmatex">\(B\)</span> drift.</li>
</ul>
<h4 id="formula_1">Formula:</h4>
<ul>
<li><strong>Drift velocity</strong> (<span class="arithmatex">\(\mathbf{v_d}\)</span>):</li>
</ul>
<div class="arithmatex">\[
\mathbf{v_d} = \frac{\mathbf{E} \times \mathbf{B}}{B^2}
\]</div>
<hr/>
<h1 id="4-effect-of-changing-physical-parameters">4. Effect of Changing Physical Parameters</h1>
<p>Each parameter influences the particle's path in different ways:</p>
<ul>
<li><strong>Charge <span class="arithmatex">\((q)\)</span></strong>: Determines direction of curvature. Opposite charges curve in opposite directions.</li>
<li><strong>Mass <span class="arithmatex">\((m)\)</span></strong>: Affects how tightly a particle spirals in a magnetic field (smaller mass → tighter spiral).</li>
<li><strong>Initial Velocity <span class="arithmatex">\((v)\)</span></strong>: Affects the size of the orbit and energy. If initial velocity is angled with respect to <span class="arithmatex">\((B)\)</span>, it creates helical motion.</li>
<li><strong>Field Strength <span class="arithmatex">\((E, B)\)</span></strong>: Stronger magnetic fields decrease orbit radius. Stronger electric fields increase acceleration and drift speed.</li>
</ul>
<hr/>
<h1 id="5-kinetic-energy-of-a-moving-particle">5. Kinetic Energy of a Moving Particle</h1>
<p>Even though the magnetic field affects the trajectory, it does not change the particle’s speed — hence, it does not do work. The electric field, however, adds energy to the particle.</p>
<h4 id="kinetic-energy-formula">Kinetic Energy Formula:</h4>
<div class="arithmatex">\[
K = \frac{1}{2} m v^2
\]</div>
<ul>
<li>In crossed fields, kinetic energy may oscillate but overall increases if the particle gains energy from <span class="arithmatex">\((E)\)</span>.</li>
</ul>
<hr/>
<h1 id="6-visualization-and-physical-interpretation">6. Visualization and Physical Interpretation</h1>
<p>The resulting motion from different field setups is visually and physically rich:</p>
<ul>
<li>In a uniform magnetic field, the particle traces circular or helical paths.</li>
<li>In an electric field, the path is a straight line with increasing speed.</li>
<li>In crossed fields, the particle shows a cycloidal trajectory and net drift.</li>
</ul>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Constants
q = 1.6e-19  # Charge (C)
m = 1.67e-27  # Mass (kg)
dt = 1e-7    # Time step (s)
t_max = 5e-5 # Total time (s)
steps = int(t_max / dt)

# Lorentz force
def lorentz_force(v, E, B):
    return (q / m) * (E + np.cross(v, B))

# RK4 step
def rk4_step(r, v, E, B, dt):
    k1_v = lorentz_force(v, E, B)
    k1_r = v
    k2_v = lorentz_force(v + 0.5 * dt * k1_v, E, B)
    k2_r = v + 0.5 * dt * k1_r
    k3_v = lorentz_force(v + 0.5 * dt * k2_v, E, B)
    k3_r = v + 0.5 * dt * k2_r
    k4_v = lorentz_force(v + dt * k3_v, E, B)
    k4_r = v + dt * k3_r
    v_new = v + (dt / 6) * (k1_v + 2 * k2_v + 2 * k3_v + k4_v)
    r_new = r + (dt / 6) * (k1_r + 2 * k2_r + 2 * k3_r + k4_r)
    return r_new, v_new

# Simulation function
def simulate(E, B, r0, v0):
    r = np.zeros((steps, 3))
    v = np.zeros((steps, 3))
    r[0], v[0] = r0, v0
    for i in range(steps - 1):
        r[i + 1], v[i + 1] = rk4_step(r[i], v[i], E, B, dt)
    return r, v

# Initial conditions
r0 = np.array([0.0, 0.0, 0.0])
v0 = np.array([1000.0, 1000.0, 0.0])
scenarios = [
    (np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.1]), "Uniform Magnetic Field"),
    (np.array([1000.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.1]), "Combined Fields"),
    (np.array([0.0, 1000.0, 0.0]), np.array([0.0, 0.0, 0.1]), "Crossed Fields")
]

# Graph 1: 3D Trajectories
fig = plt.figure(figsize=(15, 5))
for i, (E, B, title) in enumerate(scenarios, 1):
    r, _ = simulate(E, B, r0, v0)
    ax = fig.add_subplot(1, 3, i, projection='3d')
    ax.plot(r[:, 0], r[:, 1], r[:, 2], lw=1)
    ax.set_title(title)
    ax.set_xlabel('x (m)')
    ax.set_ylabel('y (m)')
    ax.set_zlabel('z (m)')
plt.tight_layout()
plt.show()

# Graph 2: 2D Projection with Larmor Radius
r, _ = simulate(scenarios[0][0], scenarios[0][1], r0, v0)  # Uniform B
plt.figure(figsize=(6, 6))
plt.plot(r[:, 0], r[:, 1], label='Trajectory')
v_perp = np.sqrt(v0[0]**2 + v0[1]**2)
r_L = m * v_perp / (q * 0.1)
circle = plt.Circle((0, 0), r_L, color='r', fill=False, linestyle='--', label=f'Larmor Radius = {r_L:.2e} m')
plt.gca().add_artist(circle)
plt.title("2D xy-Plane: Uniform Magnetic Field")
plt.xlabel('x (m)')
plt.ylabel('y (m)')
plt.legend()
plt.grid()
plt.axis('equal')
plt.show()

# Graph 3: Velocity vs. Time (x-component)
r, v = simulate(scenarios[2][0], scenarios[2][1], r0, v0)  # Crossed Fields
t = np.linspace(0, t_max, steps)
plt.figure(figsize=(8, 4))
plt.plot(t, v[:, 0], 'b-', label='v_x')
plt.title("Velocity (x-component) vs. Time: Crossed Fields")
plt.xlabel('Time (s)')
plt.ylabel('v_x (m/s)')
plt.grid()
plt.legend()
plt.show()
</code></pre>
<h1 id="7-3d-trajectories-for-all-scenarios">7. 3D Trajectories for All Scenarios</h1>
<p><img alt="alt text" src="../image.png"/></p>
<h2 id="explanation">Explanation:</h2>
<h2 id="what-it-is">What It Is:</h2>
<p>Three 3D plots showing a proton’s path in:
1. Just a magnetic field.
2. Magnetic plus electric field.
3. Crossed magnetic and electric fields.</p>
<h2 id="why-it-looks-like-that">Why It Looks Like That:</h2>
<p>The magnetic field makes the particle loop around due to:</p>
<div class="arithmatex">\[
F = q \mathbf{v} \times \mathbf{B}
\]</div>
<p>Adding an electric field:</p>
<div class="arithmatex">\[
F = q \mathbf{E}
\]</div>
<p>stretches the loops into a spiral or wavy path, depending on its direction.</p>
<h2 id="what-it-means">What It Means:</h2>
<p>Shows how:</p>
<div class="arithmatex">\[
F = q \mathbf{E} + q \mathbf{v} \times \mathbf{B}
\]</div>
<p>changes motion—circles for magnetic only, spirals or wiggles when electric is added. Think cyclotrons or plasma traps.</p>
<h1 id="8-2d-projection-with-larmor-radius-annotation-uniform-magnetic-field">8. 2D Projection with Larmor Radius Annotation (Uniform Magnetic Field)</h1>
<p><img alt="alt text" src="../image-1.png"/></p>
<h2 id="explanation_1">Explanation:</h2>
<h2 id="what-it-is_1">What It Is:</h2>
<p>A 2D top-down view of the proton’s circular path in a magnetic field, with a red circle showing the Larmor radius.</p>
<h2 id="why-it-looks-like-that_1">Why It Looks Like That:</h2>
<p>The magnetic field forces the particle into a circle with radius:</p>
<div class="arithmatex">\[
r_L = \frac{m v_{\perp}}{|q| B}
\]</div>
<p>where <span class="arithmatex">\((v_{\perp})\)</span> is the speed perpendicular to <span class="arithmatex">\(( B )\)</span>. The red circle matches this size.</p>
<h2 id="what-it-means_1">What It Means:</h2>
<p>Confirms the particle follows:</p>
<div class="arithmatex">\[
r_L = \frac{m v_{\perp}}{|q| B}
\]</div>
<p>in a magnetic field, like in a cyclotron where it spins in circles.</p>
<h1 id="9-velocity-vs-time-x-component-for-crossed-fields">9.  Velocity vs. Time (x-component) for Crossed Fields</h1>
<p><img alt="alt text" src="../image-2.png"/></p>
<h2 id="explanation_2">Explanation:</h2>
<h2 id="what-it-is_2">What It Is:</h2>
<p>A line graph of the proton’s x-speed over time when electric and magnetic fields are perpendicular.</p>
<h2 id="why-it-looks-like-that_2">Why It Looks Like That:</h2>
<p>The speed waves because:</p>
<div class="arithmatex">\[
F = q v \times B
\]</div>
<p>makes it loop, while:</p>
<div class="arithmatex">\[
F = q E
\]</div>
<p>pushes it sideways. The drift speed is:</p>
<div class="arithmatex">\[
v_d = \frac{E}{B} \left( \frac{B^2}{E} \right) = \frac{E}{B}
\]</div>
<h2 id="what-it-means_2">What It Means:</h2>
<p>Shows how velocity changes with:</p>
<div class="arithmatex">\[
\frac{d v}{d t} = \frac{q}{m} (E + v \times B)
\]</div>
<p>like in devices that filter particles by speed.</p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Constants
q = 1.6e-19
m = 1.67e-27
dt = 1e-7
t_max = 5e-5
steps = int(t_max / dt)

# Lorentz force
def lorentz_force(v, E, B):
    return (q / m) * (E + np.cross(v, B))

# RK4 step
def rk4_step(r, v, E, B, dt):
    k1_v = lorentz_force(v, E, B)
    k1_r = v
    k2_v = lorentz_force(v + 0.5 * dt * k1_v, E, B)
    k2_r = v + 0.5 * dt * k1_r
    k3_v = lorentz_force(v + 0.5 * dt * k2_v, E, B)
    k3_r = v + 0.5 * dt * k2_r
    k4_v = lorentz_force(v + dt * k3_v, E, B)
    k4_r = v + dt * k3_r
    v_new = v + (dt / 6) * (k1_v + 2 * k2_v + 2 * k3_v + k4_v)
    r_new = r + (dt / 6) * (k1_r + 2 * k2_r + 2 * k3_r + k4_r)
    return r_new, v_new

# Simulation function
def simulate(E, B, r0, v0):
    r = np.zeros((steps, 3))
    v = np.zeros((steps, 3))
    r[0], v[0] = r0, v0
    for i in range(steps - 1):
        r[i + 1], v[i + 1] = rk4_step(r[i], v[i], E, B, dt)
    return r, v

# Initial conditions
r0 = np.array([0.0, 0.0, 0.0])
v0 = np.array([1000.0, 1000.0, 0.0])

# Graph 4: B-field Variation
B_values = [0.05, 0.1, 0.2]
plt.figure(figsize=(8, 6))
for B_val in B_values:
    r, _ = simulate(np.array([0.0, 0.0, 0.0]), np.array([0.0, 0.0, B_val]), r0, v0)
    plt.plot(r[:, 0], r[:, 1], label=f'B = {B_val} T')
plt.title("2D Trajectories for Varying Magnetic Field Strength")
plt.xlabel('x (m)')
plt.ylabel('y (m)')
plt.legend()
plt.grid()
plt.axis('equal')
plt.show()
</code></pre>
<h1 id="10-parameter-exploration-b-field-variation-uniform-magnetic-field">10. Parameter Exploration - <span class="arithmatex">\(B\)</span>-field Variation (Uniform Magnetic Field)</h1>
<p><img alt="alt text" src="../image-3.png"/></p>
<h2 id="explanation_3">Explanation:</h2>
<h2 id="what-it-is_3">What It Is:</h2>
<p>A 2D plot comparing the proton’s circular paths for three magnetic field strengths (weak, medium, strong).</p>
<h2 id="why-it-looks-like-that_3">Why It Looks Like That:</h2>
<p>Stronger <span class="arithmatex">\(( B )\)</span> makes smaller circles since:</p>
<div class="arithmatex">\[
r_L = \frac{m v_{\perp}}{|q| B}
\]</div>
<p>gets smaller as <span class="arithmatex">\( B \)</span> grows, increasing the magnetic force:</p>
<div class="arithmatex">\[
F = q v \times B
\]</div>
<h2 id="what-it-means_3">What It Means:</h2>
<p>We can control circle size with <span class="arithmatex">\(( B )\)</span> in <span class="arithmatex">\(( r_L )\)</span>, useful in cyclotrons or traps where:</p>
<div class="arithmatex">\[
F = ma
\]</div>
<p>shapes orbits.</p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Constants
q = 1.6e-19
m = 1.67e-27
dt = 1e-7
t_max = 5e-5
steps = int(t_max / dt)

# Lorentz force
def lorentz_force(v, E, B):
    return (q / m) * (E + np.cross(v, B))

# RK4 step
def rk4_step(r, v, E, B, dt):
    k1_v = lorentz_force(v, E, B)
    k1_r = v
    k2_v = lorentz_force(v + 0.5 * dt * k1_v, E, B)
    k2_r = v + 0.5 * dt * k1_r
    k3_v = lorentz_force(v + 0.5 * dt * k2_v, E, B)
    k3_r = v + 0.5 * dt * k2_r
    k4_v = lorentz_force(v + dt * k3_v, E, B)
    k4_r = v + dt * k3_r
    v_new = v + (dt / 6) * (k1_v + 2 * k2_v + 2 * k3_v + k4_v)
    r_new = r + (dt / 6) * (k1_r + 2 * k2_r + 2 * k3_r + k4_r)
    return r_new, v_new

# Simulation function
def simulate(E, B, r0, v0):
    r = np.zeros((steps, 3))
    v = np.zeros((steps, 3))
    r[0], v[0] = r0, v0
    for i in range(steps - 1):
        r[i + 1], v[i + 1] = rk4_step(r[i], v[i], E, B, dt)
    return r, v

# Initial conditions
r0 = np.array([0.0, 0.0, 0.0])
v0 = np.array([1000.0, 1000.0, 0.0])

# Graph 5: 3D Scatter with Time Gradient
r, _ = simulate(np.array([1000.0, 0.0, 0.0]), np.array([0.0, 0.0, 0.1]), r0, v0)
fig = plt.figure(figsize=(8, 6))
ax = fig.add_subplot(111, projection='3d')
t = np.linspace(0, t_max, steps)
scatter = ax.scatter(r[:, 0], r[:, 1], r[:, 2], c=t, cmap='viridis')
plt.colorbar(scatter, label='Time (s)')
ax.set_title("3D Trajectory with Time Gradient: Combined Fields")
ax.set_xlabel('x (m)')
ax.set_ylabel('y (m)')
ax.set_zlabel('z (m)')
plt.show()
</code></pre>
<h1 id="11-3d-scatter-with-time-color-gradient-combined-fields">11.  3D Scatter with Time Color Gradient (Combined Fields)</h1>
<p><img alt="alt text" src="../image-4.png"/></p>
<h2 id="explanation_4">Explanation:</h2>
<h2 id="what-it-is_4">What It Is:</h2>
<p>A 3D scatter plot of the proton’s spiral path with colors from blue (start) to yellow (end) over time.</p>
<h2 id="why-it-looks-like-that_4">Why It Looks Like That:</h2>
<p>The magnetic field loops it with:</p>
<div class="arithmatex">\[
F = q v \times B
\]</div>
<p>while the electric field pulls it along x with:</p>
<div class="arithmatex">\[
F = q E
\]</div>
<p>making a stretched spiral over time:</p>
<div class="arithmatex">\[
\frac{dr}{dt} = v
\]</div>
<h2 id="what-it-means_4">What It Means:</h2>
<p>Shows motion from:</p>
<div class="arithmatex">\[
a = \frac{q}{m} (E + v \times B)
\]</div>
<p>like gaining energy in an accelerator or drifting in a trap.</p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../3%20Waves/Problem_1/" title="Interference Patterns on a Water Surface"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../5%20Circuits/Problem_1/" title="Problem 1">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../5%20Circuits/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
